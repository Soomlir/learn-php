# Запросы
```php
// Пример выборки с подготовленным выражением
$stmt = $pdo->prepare('SELECT * FROM users WHERE email = :email');
$stmt->execute(['email' => 'example@example.com']);
$user = $stmt->fetch();

if ($user) {
    echo "Пользователь найден: " . $user['name'];
} else {
    echo "Пользователь не найден";
}
```

## Метод prepare
```php
$stmt = $pdo->prepare('SELECT * FROM users WHERE email = :email');
```

### Что делает?
Метод prepare готовит SQL-запрос к выполнению, но ещё не выполняет его. Он позволяет использовать плейсхолдеры (:email — именованный параметр) вместо реальных значений. Это повышает безопасность, предотвращая SQL-инъекции.

### Что возвращает?
Возвращает объект класса PDOStatement (часто сокращённо называют $stmt). Этот объект представляет подготовленный запрос и предоставляет методы для его выполнения и получения данных.

## Метод execute
```php
$stmt->execute(['email' => 'example@example.com']);
```

### Что делает?
Выполняет подготовленный запрос, подставляя значения параметров (в данном случае email => 'example@example.com'). То есть, теперь запрос реально отправляется к базе.

### Что возвращает?
Возвращает булево значение:
- true — если запрос успешно выполнен
- false — если произошла ошибка при выполнении

## Метод fetch
```php
$user = $stmt->fetch();
```

### Что делает?
Извлекает одну строку результата запроса из набора данных. Возвращает следующую строку, которая соответствует запросу.

### Что возвращает?
В зависимости от режима выборки (fetch mode), возвращает:
- По умолчанию (если установлен PDO::FETCH_ASSOC) — ассоциативный массив, где ключи — имена колонок, значения — данные. 
- Если результата нет — возвращает false.

Пример результата:
```php
$user = [
  'id' => 5,
  'name' => 'Иван Иванов',
  'email' => 'example@example.com',
  // другие колонки...
];
```

- `prepare()` — готовит запрос, возвращает объект PDOStatement.
- `execute()` — выполняет запрос с параметрами, возвращает true/false.
- `fetch()` — получает одну строку результата, возвращает массив с данными или false, если строк больше нет.

## Как правильно использовать fetch() и перебирать результаты
```php
while ($row = $stmt->fetch(PDO::FETCH_ASSOC)) {
    // $row — ассоциативный массив с данными одной строки
    echo $row['name'] . '<br>';
}
```

- Здесь fetch(PDO::FETCH_ASSOC) возвращает следующую строку результата в виде ассоциативного массива.
- Цикл while будет повторяться, пока есть строки — то есть перебирает все строки результата по одной.

## Если хочешь получить все строки сразу — можно использовать fetchAll()
```php
$rows = $stmt->fetchAll(PDO::FETCH_ASSOC);
foreach ($rows as $row) {
    echo $row['name'] . '<br>';
}
```

- fetchAll() возвращает весь набор строк сразу в виде массива массивов.
- Это удобно, если ожидаешь небольшой объём данных и хочешь получить их одним вызовом.

Итог
- fetch() — получает одну строку результата.
- Цикл с fetch() позволяет поочерёдно обрабатывать каждую строку.
- fetchAll() — сразу возвращает все строки результата.
